import*as e from"react";import{classNames as n,ObjectUtils as t,DomHandler as l}from"primereact/utils";function r(){return r=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},r.apply(this,arguments)}function o(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,l=new Array(n);t<n;t++)l[t]=e[t];return l}function a(e){if(Array.isArray(e))return o(e)}function i(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function c(e,n){if(e){if("string"==typeof e)return o(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?o(e,n):void 0}}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e){if(Array.isArray(e))return e}function u(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var l,r,o=[],a=!0,i=!1;try{for(t=t.call(e);!(a=(l=t.next()).done)&&(o.push(l.value),!n||o.length!==n);a=!0);}catch(e){i=!0,r=e}finally{try{a||null==t.return||t.return()}finally{if(i)throw r}}return o}}function m(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p=e.memo((function(l){var r,o,a,i,d,f,h=l.node,g=e.useState(h.expanded),v=(o=2,s(r=g)||u(r,o)||c(r,o)||m()),y=v[0],N=v[1],E=!1!==h.leaf&&!(h.children&&h.children.length),b=h.children&&h.children.length?2*h.children.length:null,S=l.isSelected(h),z=!E&&y?"inherit":"hidden",C=function(e,n){l.onNodeClick(e,n)},M=function(){if(!E){var t=n("p-node-toggler-icon",{"pi pi-chevron-down":y,"pi pi-chevron-up":!y});return e.createElement("a",{href:"#",className:"p-node-toggler",onClick:function(e){return n=e,N((function(e){return!e})),void n.preventDefault();var n}},e.createElement("i",{className:t}))}return null},w=function(){var n=l.nodeTemplate&&t.getJSXElement(l.nodeTemplate,h)||h.label;return e.createElement("div",null,n)},T=(a=n("p-organizationchart-node-content",{"p-organizationchart-selectable-node":l.selectionMode&&!1!==h.selectable,"p-highlight":S},h.className),i=w(),d=M(),e.createElement("tr",null,e.createElement("td",{colSpan:b},e.createElement("div",{className:a,onClick:function(e){return C(e,h)}},i,d)))),k=e.createElement("tr",{style:{visibility:z},className:"p-organizationchart-lines"},e.createElement("td",{colSpan:b},e.createElement("div",{className:"p-organizationchart-line-down"}))),A=(f=h.children&&h.children.length,e.createElement("tr",{style:{visibility:z},className:"p-organizationchart-lines"},h.children&&1===h.children.length&&e.createElement("td",{colSpan:b},e.createElement("div",{className:"p-organizationchart-line-down"})),h.children&&h.children.length>1&&h.children.map((function(t,l){var r=n("p-organizationchart-line-left",{"p-organizationchart-line-top":0!==l}),o=n("p-organizationchart-line-right",{"p-organizationchart-line-top":l!==f-1});return[e.createElement("td",{key:l+"_lineleft",className:r}," "),e.createElement("td",{key:l+"_lineright",className:o}," ")]})))),O=e.createElement("tr",{style:{visibility:z},className:"p-organizationchart-nodes"},h.children&&h.children.map((function(n,t){return e.createElement("td",{key:t,colSpan:"2"},e.createElement(p,{node:n,nodeTemplate:l.nodeTemplate,selectionMode:l.selectionMode,onNodeClick:l.onNodeClick,isSelected:l.isSelected}))})));return e.createElement("table",{className:"p-organizationchart-table"},e.createElement("tbody",null,T,k,A,O))}));p.displayName="OrganizationChartNode";var f=e.memo(e.forwardRef((function(o,s){var u=o.value&&o.value.length?o.value[0]:null,m=function(e){if(o.selectionMode&&o.selection){if("single"===o.selectionMode)return o.selection===e?0:-1;if("multiple"===o.selectionMode)return o.selection.findIndex((function(n){return n===e}))}return-1},h=t.findDiffKeys(o,f.defaultProps),g=n("p-organizationchart p-component",o.className);return e.createElement("div",r({id:o.id,style:o.style,className:g},h),e.createElement(p,{node:u,nodeTemplate:o.nodeTemplate,selectionMode:o.selectionMode,onNodeClick:function(e,n){if(o.selectionMode){var t=e.target;if(!1===n.selectable||!l.hasClass(t,"p-node-toggler")||!l.hasClass(t,"p-node-toggler-icon"))return;var r,s=m(n),u=s>=0;"single"===o.selectionMode?u?(r=null,o.onNodeUnselect&&o.onNodeUnselect({originalEvent:e,node:n})):(r=n,o.onNodeSelect&&o.onNodeSelect({originalEvent:e,node:n})):"multiple"===o.selectionMode&&(u?(r=o.selection.filter((function(e,n){return n!==s})),o.onNodeUnselect&&o.onNodeUnselect({originalEvent:e,node:n})):(r=[].concat(a(p=o.selection||[])||i(p)||c(p)||d(),[n]),o.onNodeSelect&&o.onNodeSelect({originalEvent:e,node:n}))),o.onSelectionChange&&o.onSelectionChange({originalEvent:e,data:r})}var p},isSelected:function(e){return-1!==m(e)}}))})));f.displayName="OrganizationChart",f.defaultProps={__TYPE:"OrganizationChart",id:null,value:null,style:null,className:null,selectionMode:null,selection:null,nodeTemplate:null,onSelectionChange:null,onNodeSelect:null,onNodeUnselect:null};export{f as OrganizationChart};
