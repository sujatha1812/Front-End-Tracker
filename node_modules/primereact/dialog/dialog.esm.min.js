import*as e from"react";import t from"primereact/api";import{CSSTransition as n}from"primereact/csstransition";import{useEventListener as r,useMountEffect as o,useUpdateEffect as a,useUnmountEffect as i}from"primereact/hooks";import{Portal as l}from"primereact/portal";import{Ripple as c}from"primereact/ripple";import{DomHandler as u,UniqueComponentId as s,ZIndexUtils as m,ObjectUtils as d,classNames as p}from"primereact/utils";function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e){if(Array.isArray(e))return g(e)}function y(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function h(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function v(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(e){if(Array.isArray(e))return e}function E(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw o}}return a}}function x(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function S(e,t){return w(e)||E(e,t)||h(e,t)||x()}var k=e.forwardRef((function(g,w){var E=S(e.useState(g.id),2),x=E[0],z=E[1],C=S(e.useState(!1),2),D=C[0],R=C[1],I=S(e.useState(!1),2),N=I[0],O=I[1],P=S(e.useState(g.maximized),2),M=P[0],X=P[1],A=e.useRef(null),H=e.useRef(null),Y=e.useRef(null),T=e.useRef(null),j=e.useRef(null),_=e.useRef(null),B=e.useRef(!1),V=e.useRef(!1),J=e.useRef(null),L=e.useRef(null),W=e.useRef(null),Z=e.useRef(""),K=g.onMaximize?g.maximized:M,$=S(r({type:"keydown",listener:function(e){return de(e)}}),2),F=$[0],U=$[1],q=S(r({type:"mousemove",target:function(){return window.document},listener:function(e){return he(e)}}),2),G=q[0],Q=q[1],ee=S(r({type:"mouseup",target:function(){return window.document},listener:function(e){return ve(e)}}),2),te=ee[0],ne=ee[1],re=S(r({type:"mousemove",target:function(){return window.document},listener:function(e){return fe(e)}}),2),oe=re[0],ae=re[1],ie=S(r({type:"mouseup",target:function(){return window.document},listener:function(e){return ge(e)}}),2),le=ie[0],ce=ie[1],ue=function(e){g.onHide(),e.preventDefault()},se=function(e){g.dismissableMask&&g.modal&&H.current===e.target&&ue(e),g.onMaskClick&&g.onMaskClick(e)},me=function(e){g.onMaximize?g.onMaximize({originalEvent:e,maximized:!K}):X((function(e){return!e})),e.preventDefault()},de=function(e){var t=e.currentTarget;if(t&&t.primeDialogParams){var n=t.primeDialogParams,r=n.length,o=n[r-1]?n[r-1].id:void 0;if(o===x&&g.closeOnEscape){var a=document.getElementById(o);if(27===e.which)ue(e),e.stopImmediatePropagation(),n.splice(r-1,1);else if(9===e.which){e.preventDefault();var i=u.getFocusableElements(a);if(i&&i.length>0)if(document.activeElement){var l=i.indexOf(document.activeElement);e.shiftKey?-1===l||0===l?i[i.length-1].focus():i[l-1].focus():-1===l||l===i.length-1?i[0].focus():i[l+1].focus()}else i[0].focus()}}}},pe=function(e){u.hasClass(e.target,"p-dialog-header-icon")||u.hasClass(e.target.parentElement,"p-dialog-header-icon")||g.draggable&&(B.current=!0,J.current=e.pageX,L.current=e.pageY,A.current.style.margin="0",u.addClass(document.body,"p-unselectable-text"),g.onDragStart&&g.onDragStart(e))},fe=function(e){if(B.current){var t=u.getOuterWidth(A.current),n=u.getOuterHeight(A.current),r=e.pageX-J.current,o=e.pageY-L.current,a=A.current.getBoundingClientRect(),i=a.left+r,l=a.top+o,c=u.getViewport();A.current.style.position="fixed",g.keepInViewport?(i>=g.minX&&i+t<c.width&&(J.current=e.pageX,A.current.style.left=i+"px"),l>=g.minY&&l+n<c.height&&(L.current=e.pageY,A.current.style.top=l+"px")):(J.current=e.pageX,A.current.style.left=i+"px",L.current=e.pageY,A.current.style.top=l+"px"),g.onDrag&&g.onDrag(e)}},ge=function(e){B.current&&(B.current=!1,u.removeClass(document.body,"p-unselectable-text"),g.onDragEnd&&g.onDragEnd(e))},be=function(e){g.resizable&&(V.current=!0,J.current=e.pageX,L.current=e.pageY,u.addClass(document.body,"p-unselectable-text"),g.onResizeStart&&g.onResizeStart(e))},ye=function(e,t,n){!n&&(n=u.getViewport());var r=parseInt(e);return/^(\d+|(\.\d+))(\.\d+)?%$/.test(e)?r*(n[t]/100):r},he=function(e){if(V.current){var t=e.pageX-J.current,n=e.pageY-L.current,r=u.getOuterWidth(A.current),o=u.getOuterHeight(A.current),a=A.current.getBoundingClientRect(),i=u.getViewport(),l=!parseInt(A.current.style.top)||!parseInt(A.current.style.left),c=ye(A.current.style.minWidth,"width",i),s=ye(A.current.style.minHeight,"height",i),m=r+t,d=o+n;l&&(m+=t,d+=n),(!c||m>c)&&a.left+m<i.width&&(A.current.style.width=m+"px"),(!s||d>s)&&a.top+d<i.height&&(A.current.style.height=d+"px"),J.current=e.pageX,L.current=e.pageY,g.onResize&&g.onResize(e)}},ve=function(e){V.current&&(V.current=!1,u.removeClass(document.body,"p-unselectable-text"),g.onResizeEnd&&g.onResizeEnd(e))},we=function(){A.current.style.position="",A.current.style.left="",A.current.style.top="",A.current.style.margin=""},Ee=function(){A.current.setAttribute(Z.current,"")},xe=function(){var e;g.onShow&&g.onShow(),g.focusOnShow&&!((e=document.activeElement)&&A.current&&A.current.contains(e))&&g.closable&&g.showHeader&&_.current.focus(),ze()},Se=function(){g.modal&&u.addClass(H.current,"p-component-overlay-leave")},ke=function(){B.current=!1,m.clear(H.current),R(!1),Ce()},ze=function(){De(),(g.blockScroll||g.maximizable&&K)&&u.addClass(document.body,"p-overflow-hidden")},Ce=function(){(Re(),g.modal)?document.primeDialogParams&&document.primeDialogParams.some((function(e){return e.hasBlockScroll}))||u.removeClass(document.body,"p-overflow-hidden"):(g.blockScroll||g.maximizable&&K)&&u.removeClass(document.body,"p-overflow-hidden")},De=function(){if(g.draggable&&(oe(),le()),g.resizable&&(G(),te()),g.closable){F();var e={id:x,hasBlockScroll:g.blockScroll};document.primeDialogParams=document.primeDialogParams?[].concat(b(t=document.primeDialogParams)||y(t)||h(t)||v(),[e]):[e]}var t},Re=function(){ae(),ce(),Q(),ne(),U(),document.primeDialogParams=document.primeDialogParams&&document.primeDialogParams.filter((function(e){return e.id!==x}))},Ie=function(){if(!W.current){W.current=u.createInlineStyle(t.nonce);var e="";for(var n in g.breakpoints)e+="\n                    @media screen and (max-width: ".concat(n,") {\n                        .p-dialog[").concat(Z.current,"] {\n                            width: ").concat(g.breakpoints[n]," !important;\n                        }\n                    }\n                ");W.current.innerHTML=e}};o((function(){x||z(s()),Z.current=s(),g.visible&&R(!0),g.breakpoints&&Ie()})),a((function(){g.visible&&!D&&R(!0),g.visible!==N&&D&&O(g.visible)})),a((function(){D&&(m.set("modal",H.current,t.autoZIndex,g.baseZIndex||t.zIndex.modal),O(!0))}),[D]),a((function(){g.blockScroll||u[K?"addClass":"removeClass"](document.body,"p-overflow-hidden")}),[g.maximized,M]),i((function(){Ce(),u.removeInlineStyle(W.current),m.clear(H.current)})),e.useImperativeHandle(w,(function(){return{resetPosition:we}}));var Ne,Oe,Pe,Me,Xe,Ae,He,Ye,Te,je=function(){if(g.showHeader){var t=g.closable?e.createElement("button",{ref:_,type:"button",className:"p-dialog-header-icon p-dialog-header-close p-link","aria-label":g.ariaCloseIconLabel,onClick:ue},e.createElement("span",{className:"p-dialog-header-close-icon pi pi-times"}),e.createElement(c,null)):null,n=(a=p("p-dialog-header-maximize-icon pi",{"pi-window-maximize":!K,"pi-window-minimize":K}),g.maximizable?e.createElement("button",{type:"button",className:"p-dialog-header-icon p-dialog-header-maximize p-link",onClick:me},e.createElement("span",{className:a}),e.createElement(c,null)):null),r=d.getJSXElement(g.icons,g),o=d.getJSXElement(g.header,g);return e.createElement("div",{ref:T,className:"p-dialog-header",onMouseDown:pe},e.createElement("div",{id:x+"_header",className:"p-dialog-title"},o),e.createElement("div",{className:"p-dialog-header-icons"},r,n,t))}var a;return null},_e=function(){var t=p("p-dialog-content",g.contentClassName);return e.createElement("div",{id:x+"_content",ref:Y,className:t,style:g.contentStyle},g.children)},Be=function(){var t=d.getJSXElement(g.footer,g);return t&&e.createElement("div",{ref:j,className:"p-dialog-footer"},t)};return D&&(Oe=d.findDiffKeys(g,k.defaultProps),Pe=p("p-dialog p-component",g.className,{"p-dialog-rtl":g.rtl,"p-dialog-maximized":K}),Me=p("p-dialog-mask",(Ne=["center","left","right","top","top-left","top-right","bottom","bottom-left","bottom-right"].find((function(e){return e===g.position||e.replace("-","")===g.position})))?"p-dialog-".concat(Ne):"",{"p-component-overlay p-component-overlay-enter":g.modal,"p-dialog-visible":D,"p-dialog-draggable":g.draggable,"p-dialog-resizable":g.resizable},g.maskClassName),Xe=je(),Ae=_e(),He=Be(),Ye=g.resizable?e.createElement("div",{className:"p-resizable-handle",style:{zIndex:90},onMouseDown:be}):null,Te=e.createElement("div",{ref:H,style:g.maskStyle,className:Me,onClick:se},e.createElement(n,{nodeRef:A,classNames:"p-dialog",timeout:{enter:"center"===g.position?150:300,exit:"center"===g.position?150:300},in:N,options:g.transitionOptions,unmountOnExit:!0,onEnter:Ee,onEntered:xe,onExiting:Se,onExited:ke},e.createElement("div",f({ref:A,id:x,className:Pe,style:g.style,onClick:g.onClick,role:"dialog"},Oe,{"aria-labelledby":x+"_header","aria-describedby":x+"_content","aria-modal":g.modal}),Xe,Ae,He,Ye))),e.createElement(l,{element:Te,appendTo:g.appendTo,visible:!0}))}));k.displayName="Dialog",k.defaultProps={__TYPE:"Dialog",id:null,header:null,footer:null,visible:!1,position:"center",draggable:!0,resizable:!0,modal:!0,onHide:null,onShow:null,contentStyle:null,contentClassName:null,closeOnEscape:!0,dismissableMask:!1,rtl:!1,closable:!0,style:null,className:null,maskStyle:null,maskClassName:null,showHeader:!0,appendTo:null,baseZIndex:0,maximizable:!1,blockScroll:!1,icons:null,ariaCloseIconLabel:"Close",focusOnShow:!0,minX:0,minY:0,keepInViewport:!0,maximized:!1,breakpoints:null,transitionOptions:null,onMaximize:null,onDragStart:null,onDrag:null,onDragEnd:null,onResizeStart:null,onResize:null,onResizeEnd:null,onClick:null,onMaskClick:null};export{k as Dialog};
